(function(n,t){"use strict";var u={templates:{viewing:'<a href="#" class="clearing-close">&times;<\/a><div class="visible-img" style="display: none"><img src="#"><p class="clearing-caption"><\/p><a href="#" class="clearing-main-left"><\/a><a href="#" class="clearing-main-right"><\/a><\/div>'},initialized:!1,locked:!1},f={},r={init:function(){return this.find("ul[data-clearing]").each(function(){var o=n(document),t=n(this),i=i||{},f=f||{},e=t.data("fndtn.clearing.settings");e||(i.$parent=t.parent(),t.data("fndtn.clearing.settings",n.extend({},u,i)),r.extend(r,f),r.assemble(t.find("li")),u.initialized||r.events())})},events:function(){var i=n(document);i.on("click.fndtn.clearing","ul[data-clearing] li",function(t,i,u){var i=i||n(this),u=u||i,f=i.parent().data("fndtn.clearing.settings");t.preventDefault(),f||i.parent().foundationClearing(),r.open(n(t.target),i,u),r.update_paddles(u)});n(t).on("resize.fndtn.clearing",function(){var t=n(".clearing-blackout .visible-img").find("img");t.length>0&&r.center(t)});i.on("click.fndtn.clearing",".clearing-main-right",function(t){var i=n(".clearing-blackout").find("ul[data-clearing]");t.preventDefault(),r.go(i,"next")});i.on("click.fndtn.clearing",".clearing-main-left",function(t){var i=n(".clearing-blackout").find("ul[data-clearing]");t.preventDefault(),r.go(i,"prev")});i.on("click.fndtn.clearing","a.clearing-close, div.clearing-blackout, div.visible-img",function(t){var i=function(n){return/blackout/.test(n.selector)?n:n.closest(".clearing-blackout")}(n(this)),r,f;return this===t.target&&i&&(r=i.find("div:first"),f=r.find(".visible-img"),u.prev_index=0,i.find("ul[data-clearing]").attr("style",""),i.removeClass("clearing-blackout"),r.removeClass("clearing-container"),f.hide()),!1});i.on("keydown.fndtn.clearing",function(t){var i=n(".clearing-blackout").find("ul[data-clearing]");t.which===39&&r.go(i,"next"),t.which===37&&r.go(i,"prev"),t.which===27&&n("a.clearing-close").trigger("click")});i.on("movestart",function(n){(n.distX>n.distY&&n.distX<-n.distY||n.distX<n.distY&&n.distX>-n.distY)&&n.preventDefault()});i.bind("swipeleft","ul[data-clearing] li",function(){var t=n(".clearing-blackout").find("ul[data-clearing]");r.go(t,"next")}),i.bind("swiperight","ul[data-clearing] li",function(){var t=n(".clearing-blackout").find("ul[data-clearing]");r.go(t,"prev")}),u.initialized=!0},assemble:function(n){var t=n.parent(),i=t.data("fndtn.clearing.settings"),u=t.detach(),r={grid:'<div class="carousel">'+this.outerHTML(u[0])+"<\/div>",viewing:i.templates.viewing},f='<div class="clearing-assembled"><div>'+r.viewing+r.grid+"<\/div><\/div>";return i.$parent.append(f)},open:function(n,t,i){var e=i.closest(".clearing-assembled"),o=e.find("div:first"),u=o.find(".visible-img"),f=u.find("img").not(n);r.locked()||(f.attr("src",this.load(n)),f.is_good(function(){e.addClass("clearing-blackout"),o.addClass("clearing-container"),r.caption(u.find(".clearing-caption"),n),u.show(),r.fix_height(i),r.center(f),r.shift(t,i,function(){i.siblings().removeClass("visible"),i.addClass("visible")})}))},fix_height:function(t){var i=t.siblings();i.each(function(){var t=n(this),i=t.find("img");t.height()>i.outerHeight()&&t.addClass("fix-height")}),i.closest("ul").width(i.length*100+"%")},update_paddles:function(n){var t=n.closest(".carousel").siblings(".visible-img");n.next().length>0?t.find(".clearing-main-right").removeClass("disabled"):t.find(".clearing-main-right").addClass("disabled"),n.prev().length>0?t.find(".clearing-main-left").removeClass("disabled"):t.find(".clearing-main-left").addClass("disabled")},load:function(n){var t=n.parent().attr("href");return(this.preload(n),t)?t:n.attr("src")},preload:function(n){var t=n.closest("li").next(),i=n.closest("li").prev(),r,u,f,e;t.length>0&&(f=new Image,r=t.find("a"),f.src=r.length>0?r.attr("href"):t.find("img").attr("src")),i.length>0&&(e=new Image,u=i.find("a"),e.src=u.length>0?u.attr("href"):i.find("img").attr("src"))},caption:function(n,t){var i=t.data("caption");i?n.text(i).show():n.text("").hide()},go:function(n,t){var r=n.find(".visible"),i=r[t]();i.length>0&&i.find("img").trigger("click",[r,i])},shift:function(n,t,i){var f=t.parent(),l=f.closest(".clearing-container"),a=t.position().left,v=f.position().left,c=u.prev_index,e=this.direction(f,n,t),h=parseInt(f.css("left"),10),o=t.outerWidth(),s;t.index()===c||/skip/.test(e)?/skip/.test(e)&&(s=t.index()-u.up_count,r.lock(),s>0?f.animate({left:-(s*o)},300,r.unlock):f.animate({left:0},300,r.unlock)):/left/.test(e)?(r.lock(),f.animate({left:h+o},300,r.unlock)):/right/.test(e)&&(r.lock(),f.animate({left:h-o},300,r.unlock)),i()},lock:function(){u.locked=!0},unlock:function(){u.locked=!1},locked:function(){return u.locked},direction:function(t,i,r){var e=t.find("li"),h=e.outerWidth()+e.outerWidth()/4,c=n(".clearing-container"),s=Math.floor(c.outerWidth()/h)-1,l=e.length-s,f=e.index(r),a=e.index(i),o;return u.up_count=s,o=this.adjacent(u.prev_index,f)?f>s&&f>u.prev_index?"right":f>s-1&&f<=u.prev_index?"left":!1:"skip",u.prev_index=f,o},adjacent:function(n,t){return t-1===n?!0:t+1===n||t===n?!0:!1},center:function(n){n.css({marginLeft:-(n.outerWidth()/2),marginTop:-(n.outerHeight()/2)})},outerHTML:function(n){return n.outerHTML||(new XMLSerializer).serializeToString(n)},extend:function(t,i){n.each(t,function(n,t){i.hasOwnProperty(n)&&(f[n]=t)}),n.extend(r,i)},_super:function(n,t){return f[n].apply(this,t)}};n.fn.foundationClearing=function(t){if(r[t])return r[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Method "+t+" does not exist on jQuery.foundationClearing");else return r.init.apply(this,arguments)},function(n){n.fn.is_good=function(t,i){function r(){f-=1,f||t()}function o(){this.one("load",r);if(n.browser.msie){var t=this.attr("src"),i=t.match(/\?/)?"&":"?";i+=e.cachePrefix+"="+ +new Date,this.attr("src",t+i)}}var e=n.extend({},n.fn.is_good.defaults,i),u=this.find("img").add(this.filter("img")),f=u.length;return u.each(function(){var t=n(this);if(!t.attr("src")){r();return}this.complete||this.readyState===4?r():o.call(t)})},n.fn.is_good.defaults={cachePrefix:"random"}}(jQuery)})(jQuery,this);